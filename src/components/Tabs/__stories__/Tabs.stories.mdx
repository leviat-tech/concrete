import { ArgsTable, Story, Canvas, Meta, Source } from '@storybook/addon-docs';
import { userEvent, screen, within } from '@storybook/testing-library';
import { expect } from '@storybook/jest';
import CTabs from '../Tabs.vue';
import CTabPanel from '../CTabPanel.vue';

<Meta
  title="Components/Tabs"
  component={CTabs}
  argTypes={{
    tabPosition: {
      options: ['top', 'bottom'],
      control: { type: 'select' },
      table: {
        type: { summary: 'string' },
      },
    },
  }}
/>

<!--- Component template -->

export const componentTemplate = (args) => ({
  components: { CTabs, CTabPanel },
  setup() {
    return { args };
  },
  data: () => ({ value: '' }),
  template: `
  <CTabs v-bind="args" class="border"> 
    <template #panels> 
      <CTabPanel>Panel 1</CTabPanel> 
      <CTabPanel>Panel 2</CTabPanel> 
      <CTabPanel>Panel 3</CTabPanel> 
    </template>
  </CTabs>`,
});

<!--- Component documentation -->

# Tabs

<Canvas withSource="open">
  <Story
    name="Overview"
    args={{
      tabPosition: 'top',
      labels: ['Tab 1', 'Tab 2', 'Tab 3'],
    }}
    play={async ({ canvasElement }) => {
      const canvas = within(canvasElement);
      // Check that 3 tabs are displayed
      const tabs = await screen.findByRole('tablist');
      const numberOfTabs = tabs.children.length;
      expect(numberOfTabs).toBe(3);
      // All tabs are visible
      await screen.findByText('Tab 1');
      await screen.findByText('Tab 2');
      await screen.findByText('Tab 3');
      // Click on the second tab and assert that panel is displayed
      await userEvent.click(canvas.getByRole('tab', { name: 'Tab 2' }));
      await screen.findByText('Panel 2');
      // Click on the third tab and assert that panel is displayed
      await userEvent.click(canvas.getByRole('tab', { name: 'Tab 3' }));
      await screen.findByText('Panel 3');
      // Click on the first tab and assert that panel is displayed
      await userEvent.click(canvas.getByRole('tab', { name: 'Tab 1' }));
      await screen.findByText('Panel 1');
    }}
  >
    {componentTemplate.bind({})}
  </Story>
</Canvas>

## Overview

Tabs component provides a way to view tabbed/paned content.

### Labels

You can either provide labels as an array of strings using the prop :labels , or as a slot #labels  
When using the slot, be sure to use only CTabLabel component

### Content

You can provide using the slot #panels  
When using the slot, be sure to only use CTabPanel component

Making sure to add relevant classes and style accordingly for height, padding overflow etc on CTabPanel

## Props

<ArgsTable story="Overview" />
